!function(e){function t(){return n?n.promise():(n=e.Deferred(),e.ajax({url:a,dataType:"script",success:function(){d=_.map(window.EVENT_DATA.results,function(e){return{title:e.name,start:e.start_dt,date:e.start_day}}),n.resolve(d)}}),n.promise())}var n,a="http://d2bq2yf31lju3q.cloudfront.net/js/event-data.gz",r={maxEvents:10,fullCalendar:{header:{left:"prev,next, today",center:"title",right:"month,agendaWeek,agendaDay"}}},d=[];e.fn.bernieCalendar=function(n){return this.each(function(){var a=e.extend({},r,n);a.fullCalendar.events=function(e,n,r,d){t().then(function(e){e=_.chain(e).reduce(function(e,t){return t.date in e?e[t.date].length<a.maxEvents&&e[t.date].push(t):e[t.date]=[t],e},{}),e=e.values().flatten().value(),d(e)})},e(this).addClass("bernie-calendar"),e(this).fullCalendar(a.fullCalendar)})}}(jQuery);